name = "adobe-commerce-catalog-ci"
main = "dist/index.mjs"
compatibility_date = "2024-03-21"
account_id = "852dfa4ae1b0d579df29be65b986c101"
workers_dev = true
send_metrics = false


build = { command = "npm install && node build.js" }

[vars]
VERSION = "@@VERSION@@-dev"

kv_namespaces = [
  { binding = "CONFIGS", id = "bb91e12a65a8462282396f32e63406f1", preview_id = "bb91e12a65a8462282396f32e63406f1" }
]

[[r2_buckets]]
binding = "CATALOG_BUCKET"
preview_bucket_name = "adobe-commerce-catalog-dev"
bucket_name = "adobe-commerce-catalog"

# ----------------------------------------------------------------------
# dev environment

[env.dev]
name = "adobe-commerce-catalog-dev"

[[env.dev.r2_buckets]]
binding = "CATALOG_BUCKET"
preview_bucket_name = "adobe-commerce-catalog-dev"
bucket_name = "adobe-commerce-catalog-ci"

[env.dev.vars]
VERSION = "@@VERSION@@-dev"
ENVIRONMENT = "dev"

# ----------------------------------------------------------------------
# ci environment

[env.ci]
name = "adobe-commerce-catalog-ci"

kv_namespaces = [
  { binding = "CONFIGS", id = "bb91e12a65a8462282396f32e63406f1", preview_id = "bb91e12a65a8462282396f32e63406f1" }
]

[[env.ci.r2_buckets]]
binding = "CATALOG_BUCKET"
preview_bucket_name = "adobe-commerce-catalog-dev"
bucket_name = "adobe-commerce-catalog-ci"

[[env.ci.queues.producers]]
queue = "adobe-commerce-catalog-queue"
binding = "COMMERCE_QUEUE"

[[env.ci.queues.consumers]]
 queue = "adobe-commerce-catalog-queue"
 binding = "COMMERCE_QUEUE"
 max_batch_size = 1
 max_batch_timeout = 5

[env.ci.vars]
VERSION = "@@VERSION@@-ci"
ENVIRONMENT = "ci"

# ----------------------------------------------------------------------
# production environment

[env.production]
name = "adobe-commerce-catalog"

kv_namespaces = [
  { binding = "CONFIGS", id = "bb91e12a65a8462282396f32e63406f1", preview_id = "bb91e12a65a8462282396f32e63406f1" }
]

[[env.production.r2_buckets]]
binding = "CATALOG_BUCKET"
preview_bucket_name = "adobe-commerce-catalog-dev"
bucket_name = "adobe-commerce-catalog"

[[env.production.queues.producers]]
queue = "adobe-commerce-catalog-queue"
binding = "COMMERCE_QUEUE"

[[env.production.queues.consumers]]
 queue = "adobe-commerce-catalog-queue"
 binding = "COMMERCE_QUEUE"
 max_batch_size = 10
 max_batch_timeout = 5

[env.production.vars]
VERSION = "@@VERSION@@"
ENVIRONMENT = "prod"

# [secrets]
# ...